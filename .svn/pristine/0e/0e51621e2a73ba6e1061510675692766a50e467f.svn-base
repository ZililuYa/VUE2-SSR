<template>
  <div>
    <win-header></win-header>
    <router-view></router-view>
  </div>
</template>
<script>
import WinHeader from 'components/header/Header'
import api from 'src/api/'

export default {
  mounted() {
    // 客户端请求axios
  },
  created() {
    // 客户端 服务端同时请求axios
    this.getUserStatus()
  },
  asyncData({ store, route, cookies }) {
    // 服务端请求axios
  },
  components: {
    WinHeader
  },
  methods: {
    getUserStatus() {
      api.get('/isLogin').then((response) => {
        console.log(response.code)
        // 403无权限访问
        if (response.code === 403) {
          this.$confirm({
            title: '访问受限',
            okText: '重新登录',
            cancelText: '返回',
            content: '抱歉，您无权访问『首页』模块的『首页』功能。请联系管理员获取权限。'
          }).then(() => {
            this.$router.replace({ path: '/login' })
          }).catch(() => {
            this.$router.replace({ path: '/login' })
          })
        }
      }).catch((error) => {
        console.log(error)
      })
    }
  }
}

</script>
