<template>
  <div>
    <div class="featurebar featurebar-right">
      <ul class="ul">
        <li id="undoneTab" class="active">浏览分组</li>
        <li class="pull-right"><button class="btn btn-primary" @click="moduleModal=true">按模块分配权限</button></li>
        <li class="pull-right"><a href="javascript:void(0);" @click="addModal=true" @hide="addModalClose"> <span class="glyphicon glyphicon-plus"></span> 新增分组</a></li>
      </ul>
    </div>
    <div class="main">
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>编号</th>
            <th>分组名称</th>
            <th>分组描述</th>
            <th>用户列表</th>
            <th>操作</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1</td>
            <td>管理员</td>
            <td>系统管理员</td>
            <td>彭于晏 彭于晏 彭于晏 彭于晏 彭于晏 彭于晏 彭于晏 彭于晏 彭于晏 彭于晏 彭于晏 彭于晏</td>
            <td>
              <a href="/organization/power/view" title="视图维护"><span class="glyphicon glyphicon-eye-open"></span></a>
              <a href="/organization/power/editPower" title="权限维护"><span class="glyphicon glyphicon-lock"></span></a>
              <a href="javascript:void(0);" @click="numberModal=true" title="成员维护"><span class="glyphicon glyphicon-user"></span></a>
              <a href="javascript:void(0);" @click="addModal=true" @hide="addModalClose" title="编辑分组"><span class="glyphicon glyphicon-pencil"></span></a>
              <a href="javascript:void(0);" title="复制分组"><span class="glyphicon glyphicon-book"></span></a>
              <a href="javascript:void(0);" @click="delGroup" title="删除分组"><span class="glyphicon glyphicon-remove"></span></a>
            </td>
          </tr>
          <tr>
            <td>2</td>
            <td>管理员</td>
            <td>系统管理员</td>
            <td>胡一天</td>
            <td>
              <a href="/organization/editUser" title="视图维护"><span class="glyphicon glyphicon-eye-open"></span></a>
              <a href="javascript:void(0);" title="权限维护"><span class="glyphicon glyphicon-lock"></span></a>
              <a href="javascript:void(0);" title="成员维护"><span class="glyphicon glyphicon-user"></span></a>
              <a href="javascript:void(0);" title="编辑分组"><span class="glyphicon glyphicon-pencil"></span></a>
              <a href="javascript:void(0);" title="复制分组"><span class="glyphicon glyphicon-book"></span></a>
              <a href="javascript:void(0);" title="删除分组"><span class="glyphicon glyphicon-remove"></span></a>
            </td>
          </tr>
        </tbody>
      </table>
      <div class="row">
        <pagination v-model="currentPage" :total-page="totalPage" align="center"/>
      </div>
    </div>
    <modal v-model="addModal" title="新增分组" @hide="addModalClose" ref="modal" id="add_modal">
      <form class="form-horizontal">
        <div class="form-group">
          <label for="name" class="col-sm-2 control-label"><span class="text-danger">* </span>分组名称</label>
          <div class="col-sm-10">
            <input v-model="addForm.name" type="text" class="form-control">
          </div>
        </div>
        <div class="form-group">
          <label for="name" class="col-sm-2 control-label">分组描述</label>
          <div class="col-sm-10">
            <textarea v-model="addForm.describe" class="form-control" rows="3"></textarea>
          </div>
        </div>
      </form>
      <div slot="footer">
        <btn type="primary">添加</btn>
        <btn @click="addModal=false">取消</btn>
      </div>
    </modal>
    <modal v-model="numberModal" title="成员维护" @hide="" ref="modal" id="number_modal" size="lg">
      <number></number>
      <div slot="footer">
        <btn type="primary">保存</btn>
        <btn @click="numberModal=false">返回</btn>
      </div>
    </modal>
    <modal v-model="moduleModal" title="权限维护" @hide="moduleModal=false" ref="modal" id="module_modal" size="lg" :footer="false">
      <module-power></module-power>
    </modal>
  </div>
</template>

<script>
  import { mapGetters } from 'vuex'
  import number from '../components/number.vue'
  import modulePower from '../components/modulePower.vue'
  export default {
    name: 'power',
    data () {
      return {
        currentPage: 1,
        totalPage: 99,
        addModal: false,
        numberModal: false,
        moduleModal: false,
        addForm: {
          name: '',
          describe: ''
        }
      }
    },
    components: {
      number,
      modulePower
    },
    computed: {
      ...mapGetters({
        state: 'projectState'
      })
    },
    asyncData ({store}) {
      store.dispatch('isProjectState')
    },
    methods: {
      delGroup () {
        /**
         * 删除分组
         */
        let vm = this
        this.$confirm({
          title: '提示',
          okText: '确定',
          cancelText: '取消',
          content: '您确定删除该用户分组吗？'
        }).then(() => {
          vm.doDel()
        }).catch(() => {
        })
      },
      doDel () {
        /**
         * 执行删除分组
         */
      },
      addModalClose () {
        /**
         * 弹窗关闭
         */
        let vm = this
        vm.addForm.name = ''
        vm.addForm.describe = ''
      }
    }
  }
</script>

<style lang="less">
  .main {
    padding: 20px;
  }
  .featurebar-right {
    display: block;
    width: 100%;
    font-size: 14px;
    background: #ebf1f9;
    border-bottom: 1px solid #ddd;
    line-height: 30px;
    min-height: 46px;
    .ul {
      margin: 0;
      padding: 8px 13px;
      li {
        padding:0 10px;
        float: left;
        line-height: 30px;
        transition: all 0.3s;
        button {
          margin-top: -4px;
        }
        a {
          color: #141414;
          display: block;
          padding: 0 7px;
          text-decoration: none;
          font-size: 13px;
        }
        &.active {
          font-weight: bold;
        }
        &:hover {
          background-color: rgb(221, 221, 221);
        }
      }
    }
  }
  #add_modal {
    .control-label {
      text-align: left;
    }
  }
</style>
