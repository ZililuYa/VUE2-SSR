<template>
  <div class="row">
    <div class="panel panel-default art-panel-info">
      <div class="panel-heading">编辑用户 -> {{datas.name}}</div>
      <div class="panel-body">
        <form class="form-horizontal">
          <div class="form-group">
            <label for="inputEmail3" class="col-sm-2 control-label"><span class="text-danger">* </span> 用户名</label>
            <div class="col-sm-10">
              <input type="text" v-model="data.name" class="form-control" id="inputEmail3">
            </div>
          </div>
          <div class="form-group">
            <label for="inputEmail3" class="col-sm-2 control-label"><span class="text-danger">* </span> 真实姓名</label>
            <div class="col-sm-10">
              <input type="text" v-model="userDatas.truename" class="form-control" id="inputEmail3">
            </div>
          </div>
          <div class="form-group">
            <label for="inputEmail3" class="col-sm-2 control-label"><span class="text-danger">* </span> 邮箱</label>
            <div class="col-sm-10">
              <input type="email" v-model="datas.email" class="form-control" id="exampleInputEmail1">
            </div>
          </div>
          <div class="form-group">
            <label for="inputPassword3" class="col-sm-2 control-label"><span class="text-danger">* </span> 密码</label>
            <div class="col-sm-10">
              <input type="password" v-model="datas.passwd" class="form-control" id="inputPassword3">
            </div>
          </div>
          <div class="form-group">
            <label for="inputPassword3" class="col-sm-2 control-label"><span class="text-danger">* </span> 所属部门</label>
            <div class="col-sm-10">
              <select class="form-control">
                <option v-for="item in departmentList" :value="item.id">{{item.name}}</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            {{jobList}}
            <label for="inputPassword3" class="col-sm-2 control-label">职位</label>
            <div class="col-sm-10">
              <select class="form-control">
                <option v-for="item in jobList" :value="item.id">{{item.name}}</option>
              </select>
            </div>
          </div>
          <div class="form-group art-btn-group">
            <btn class="" type="primary" @click="submits">保存</btn>
            <btn class="">返回</btn>
          </div>
        </form>
      </div>
    </div>
  </div>
</template>

<script>
import { mapGetters } from 'vuex'
import api from 'src/api'

export default {
  name: 'User',
  data () {
    return {
      data: {}
    }
  },
  props: ['userDatas'],
  computed: {
    ...mapGetters({
      departmentList: 'departmentList',  // 部门
      jobList: 'jobList'    // 职位
    }),
    datas () {
      return this.userDatas
    }
  },
  components: {},
  created () {
    // this.datas = this.userDatas
  },
  // asyncData ({ store }) {
  //   store.dispatch('isJob')
  //   store.dispatch('isDepartment')
  // },
  mounted () {
    // 客户端
    console.log(this.userDatas)
    for (var i in this.userDatas) {
      this.data[i] = this.userDatas[i]
    }
    console.log(this.data)
  },
  methods: {
    submits () {
      const param = { loginName: this.user, passwd: this.pass }
      api.post('/login', param).then((response) => {
        if (response.httpCode === 200) {
          // this.$router.replace({ path: '/' })
        } else {
          this.$notify({
            type: 'danger',
            content: '用户名或密码错误!'
          })
        }
      }).catch((error) => {
        console.log(error)
      })
    }
  }
}
</script>
<style>
.art-panel-info {
  width:80%;
  margin:15px auto 30px;
}
.art-btn-group {
  text-align: center;
}
</style>
